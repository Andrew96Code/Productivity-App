<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Productivity App</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="{{ url_for('static', filename='js/auth.js') }}"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script src="{{ url_for('static', filename='js/prize_draw.js') }}"></script>
</head>
<body class="bg-gray-100">
    <!-- Welcome Section -->
    <div class="bg-blue-600 text-white py-16">
        <div class="max-w-6xl mx-auto px-4 text-center">
            <h1 class="text-4xl font-bold mb-4">Welcome to Daily Productivity</h1>
            <p class="text-xl mb-8">Track your habits, learn something new, and improve every day.</p>
        </div>
    </div>

    <!-- Auth Section -->
    <div class="max-w-6xl mx-auto mt-8 px-4">
        <div class="grid md:grid-cols-2 gap-8">
            <!-- Login Form -->
            <div class="bg-white p-8 rounded-lg shadow-md">
                <h2 class="text-2xl font-bold mb-6">Login</h2>
                <div id="loginError" class="hidden mb-4 p-3 bg-red-100 text-red-700 rounded"></div>
                <form onsubmit="login(event)">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="loginEmail">Email</label>
                        <input type="email" id="loginEmail" name="loginEmail" class="w-full px-3 py-2 border rounded-lg" required>
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" name="loginPassword" class="w-full px-3 py-2 border rounded-lg" required>
                    </div>
                    <button type="submit" id="loginButton" class="w-full bg-blue-500 text-white py-2 rounded-lg hover:bg-blue-600">Login</button>
                </form>
            </div>

            <!-- Sign Up Form -->
            <div class="bg-white p-8 rounded-lg shadow-md">
                <h2 class="text-2xl font-bold mb-6">Sign Up</h2>
                <div id="signupError" class="hidden mb-4 p-3 bg-red-100 text-red-700 rounded"></div>
                <form onsubmit="signup(event)">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="signupEmail">Email</label>
                        <input type="email" id="signupEmail" name="signupEmail" class="w-full px-3 py-2 border rounded-lg" required>
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="signupPassword">Password</label>
                        <input type="password" id="signupPassword" name="signupPassword" class="w-full px-3 py-2 border rounded-lg" minlength="6" required>
                        <p class="text-sm text-gray-600 mt-1">Password must be at least 6 characters long</p>
                    </div>
                    <button type="submit" id="signupButton" class="w-full bg-green-500 text-white py-2 rounded-lg hover:bg-green-600">Create Account</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Main Content (hidden until logged in) -->
    <div id="mainContent" class="hidden max-w-6xl mx-auto mt-8 px-4">
        <!-- Progress Bar -->
        <div class="mb-8">
            <div class="relative pt-1">
                <div class="flex mb-2 items-center justify-between">
                    <div>
                        <span class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-blue-600 bg-blue-200">
                            Daily Progress
                        </span>
                    </div>
                    <div class="text-right">
                        <span class="text-xs font-semibold inline-block text-blue-600" id="progressPercentage">
                            0%
                        </span>
                    </div>
                </div>
                <div class="overflow-hidden h-2 mb-4 text-xs flex rounded bg-blue-200">
                    <div id="progressBar" class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-500" style="width: 0%"></div>
                </div>
            </div>
        </div>

        <!-- Time Period Indicator -->
        <div class="mb-8 text-center">
            <span id="timePeriodBadge" class="inline-block px-4 py-2 rounded-full text-white font-semibold"></span>
        </div>

        <!-- Tabs -->
        <div class="mb-4 border-b border-gray-200">
            <ul class="flex flex-wrap -mb-px" role="tablist">
                <li class="mr-2">
                    <button class="tab-button inline-block p-4 border-b-2 rounded-t-lg" data-tab="habits">
                        Habits & Goals
                    </button>
                </li>
                <li class="mr-2">
                    <button class="tab-button inline-block p-4 border-b-2 rounded-t-lg" data-tab="focus">
                        Focus & Time
                    </button>
                </li>
                <li class="mr-2">
                    <button class="tab-button inline-block p-4 border-b-2 rounded-t-lg" data-tab="learning">
                        Learning
                    </button>
                </li>
                <li class="mr-2">
                    <button class="tab-button inline-block p-4 border-b-2 rounded-t-lg" data-tab="wellness">
                        Wellness
                    </button>
                </li>
                <li class="mr-2">
                    <button class="tab-button inline-block p-4 border-b-2 rounded-t-lg" data-tab="social">
                        Social
                    </button>
                </li>
                <li>
                    <button class="tab-button inline-block p-4 border-b-2 rounded-t-lg" data-tab="rewards">
                        Rewards
                    </button>
                </li>
            </ul>
        </div>

        <!-- Tab Content -->
        <div class="tab-content bg-white p-6 rounded-lg shadow-md">
            <!-- Navigation Buttons -->
            <div class="flex justify-between mb-4">
                <button id="prevButton" class="hidden px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Previous</button>
                <button id="nextButton" class="hidden px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Next</button>
            </div>
            
            <!-- Tab Content Container -->
            <div id="tabContent">
                <!-- Content will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        let completedTasks = new Set();
        
        const taskFlow = [
            { tab: 'habits', tasks: ['Set daily goals', 'Review habits'] },
            { tab: 'focus', tasks: ['Plan focus sessions', 'Set priorities'] },
            { tab: 'learning', tasks: ['Choose learning path', 'Complete daily quiz'] },
            { tab: 'wellness', tasks: ['Log mood', 'Track wellness activities'] },
            { tab: 'social', tasks: ['Check team challenges', 'Connect with friends'] },
            { tab: 'rewards', tasks: ['Review points', 'Check prize draw entries'] }
        ];

        function updateProgress() {
            const totalTasks = taskFlow.reduce((sum, section) => sum + section.tasks.length, 0);
            const progress = (completedTasks.size / totalTasks) * 100;
            document.getElementById('progressBar').style.width = `${progress}%`;
            document.getElementById('progressPercentage').textContent = `${Math.round(progress)}%`;
        }

        function navigateTask(direction) {
            console.log('Navigating:', direction);
            const currentTaskSet = taskFlow[currentTaskIndex];
            
            if (direction === 'next') {
                // Check if current tasks are completed
                const isComplete = checkTaskCompletion(currentTaskSet.tab);
                console.log('Tasks completed check:', isComplete);
                
                if (isComplete) {
                    // Mark current tasks as completed
                    currentTaskSet.tasks.forEach(task => completedTasks.add(`${currentTaskSet.tab}-${task}`));
                    
                    if (currentTaskIndex < taskFlow.length - 1) {
                        currentTaskIndex++;
                        console.log('Moving to next tab:', taskFlow[currentTaskIndex].tab);
                        switchTab(taskFlow[currentTaskIndex].tab);
                    } else {
                        console.log('All tasks completed, adding prize draw entry');
                        addPrizeDrawEntry();
                    }
                    
                    updateProgress();
                    updateNavigationButtons();
                } else {
                    console.log('Tasks not completed');
                }
            } else if (direction === 'prev' && currentTaskIndex > 0) {
                currentTaskIndex--;
                console.log('Moving to previous tab:', taskFlow[currentTaskIndex].tab);
                switchTab(taskFlow[currentTaskIndex].tab);
                updateProgress();
                updateNavigationButtons();
            }
        }
    </script>
</body>
</html> 